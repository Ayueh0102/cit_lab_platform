# Google Sheets 範本建立指南

## 📋 快速開始

### Step 1: 建立新的 Google Sheets 試算表

1. 前往 [Google Sheets](https://sheets.google.com/)
2. 點擊「空白」建立新試算表
3. 將試算表命名為: **色彩與照明科技研究所 - 系友資料庫**

---

## 📊 建立 7 個分頁 (Sheet Tabs)

請按順序建立以下分頁:

1. **系友帳號清單**
2. **職缺發布清單**
3. **活動清單**
4. **公告發布清單**
5. **工作經歷記錄**
6. **職缺交流請求**
7. **活動報名記錄**

---

## 📥 匯入 CSV 資料

### 方法 1: 直接複製貼上(最簡單)

1. 在本地用 Excel 或文字編輯器開啟 CSV 檔案
2. 全選內容 (Cmd+A 或 Ctrl+A)
3. 複製 (Cmd+C 或 Ctrl+C)
4. 在對應的 Google Sheets 分頁中,點擊 A1 儲存格
5. 貼上 (Cmd+V 或 Ctrl+V)

### 方法 2: 使用 Google Sheets 匯入功能

1. 在 Google Sheets 中,點擊「檔案」→「匯入」
2. 選擇「上傳」分頁
3. 拖曳 CSV 檔案或點擊「瀏覽」選擇檔案
4. 匯入位置選擇:
   - **取代目前的工作表** (如果是新分頁)
   - **附加到目前的工作表** (如果要新增資料)
5. 分隔符號類型: **自動偵測**
6. 點擊「匯入資料」

---

## 🎨 美化與資料驗證設定

### 分頁 1: 系友帳號清單

#### 設定標題列樣式
1. 選取第 1 列(標題列)
2. 格式 → 粗體、置中對齊
3. 背景顏色: 淺藍色
4. 固定列: 檢視 → 固定 → 1 列

#### 設定欄位寬度
建議寬度:
- ID: 50px
- 電子郵件: 200px
- 姓名: 120px
- 畢業年份: 100px
- 其他欄位: 150-180px

#### 資料驗證
暫無需特別設定(未來擴充可加入下拉選單)

---

### 分頁 2: 職缺發布清單

#### 設定標題列
同上方法設定標題列樣式

#### 欄位寬度建議
- ID: 50px
- 發布者: 120px
- 職缺標題: 250px
- 公司名稱: 150px
- 地點: 120px
- 薪資範圍: 120px
- 職缺描述: 400px (可設定文字換行)
- 交流請求數: 100px
- 發布日期: 120px

#### 設定文字換行
1. 選取「職缺描述」欄位
2. 格式 → 文字換行 → 自動換行

---

### 分頁 3: 活動清單

#### 設定標題列
同上方法

#### 新增報名率公式(如果需要)
如果「報名率」欄位為空,可使用公式:
```
=IF(G2>0, H2/G2, 0)
```
(假設 G 欄是名額, H 欄是已報名人數)

#### 格式化報名率為百分比
1. 選取報名率欄位
2. 格式 → 數字 → 百分比

#### 條件格式化(報名率視覺化)
1. 選取報名率欄位(I2:I100)
2. 格式 → 條件式格式
3. 規則:
   - 如果報名率 >= 80%: 綠色背景
   - 如果報名率 50-79%: 黃色背景
   - 如果報名率 < 50%: 紅色背景

---

### 分頁 4: 公告發布清單

#### 置頂公告突顯
1. 選取「是否置頂」欄位
2. 格式 → 條件式格式
3. 規則: 如果等於「是」→ 該列背景色設為淺黃色

---

### 分頁 5: 工作經歷記錄

#### 設定目前在職突顯
1. 選取「目前在職」欄位
2. 條件式格式:
   - 等於「是」→ 綠色背景
   - 等於「否」→ 灰色背景

#### 使用者姓名自動填入(使用 VLOOKUP)
如果需要根據「使用者ID」自動填入姓名:
```
=IFERROR(VLOOKUP(B2,系友帳號清單!A:C,3,0),"")
```
(假設 B 欄是使用者ID)

---

## 🔧 進階功能(選用)

### 1. 建立資料透視表

**範例: 公司分布統計**
1. 選取系友帳號清單的資料範圍
2. 插入 → 資料透視表
3. 列: 目前公司
4. 值: 計數(ID)

### 2. 建立圖表

**範例: 活動報名趨勢圖**
1. 選取活動清單的相關資料
2. 插入 → 圖表
3. 選擇適合的圖表類型(如:柱狀圖、折線圖)

### 3. 資料驗證下拉選單

**範例: 為工作經歷記錄的「類型」欄位設定下拉選單**
1. 選取「類型」欄位(G2:G100)
2. 資料 → 資料驗證
3. 準則: 清單項目
4. 輸入: `全職,兼職,實習,約聘`
5. 儲存

---

## 📤 匯出資料回系統

### 方法: 下載 CSV 後匯入系統

1. 在 Google Sheets 中,選擇要匯出的分頁
2. 檔案 → 下載 → 逗號分隔值(.csv)
3. 登入系友會平台管理後台
4. 資料管理 → 匯入 CSV
5. 選擇對應的資料類型(系友資料/職缺/活動等)
6. 上傳 CSV 檔案
7. 確認匯入

---

## 🔄 日常使用流程

### 更新流程(從 Sheets 到系統)
```
1. 在 Google Sheets 編輯資料
   ↓
2. 檔案 → 下載 → CSV
   ↓
3. 登入管理後台
   ↓
4. 資料管理 → 匯入 CSV
   ↓
5. 選擇檔案 → 上傳
   ↓
6. 系統更新完成
```

### 同步流程(從系統到 Sheets)
```
1. 登入管理後台
   ↓
2. 資料管理 → 匯出 CSV
   ↓
3. 下載 CSV 檔案
   ↓
4. 開啟 Google Sheets
   ↓
5. 檔案 → 匯入 → 上傳 CSV
   ↓
6. 選擇「取代目前的工作表」
   ↓
7. Google Sheets 更新完成
```

---

## 📋 CSV 檔案對應表

| CSV 檔案                    | Google Sheets 分頁 | 說明                     |
|----------------------------|--------------------|--------------------------|
| 01_系友帳號清單.csv         | 系友帳號清單        | 系友基本資料與個人檔案   |
| 02_職缺發布清單.csv         | 職缺發布清單        | 所有已發布的職缺         |
| 03_活動清單.csv             | 活動清單            | 活動資訊與報名統計       |
| 04_公告發布清單.csv         | 公告發布清單        | 公告與公佈欄內容         |
| 05_工作經歷記錄.csv         | 工作經歷記錄        | 系友工作經歷記錄         |
| 06_職缺交流請求.csv         | 職缺交流請求        | 職缺交流請求記錄         |
| 07_活動報名記錄.csv         | 活動報名記錄        | 活動報名明細             |

---

## ⚙️ 權限設定建議

### 分享設定
1. 點擊右上角「共用」按鈕
2. 新增協作者的電子郵件
3. 權限設定:
   - **管理員**: 編輯者
   - **系友會幹部**: 編輯者
   - **一般系友**: 檢視者(唯讀)

### 通知設定
1. 工具 → 通知規則
2. 設定:
   - 任何變更 → 立即傳送電子郵件通知
   - 或: 每日摘要

---

## 🔒 安全性注意事項

1. ✅ **不要將 Google Sheets 設為「知道連結的任何人」**
2. ✅ **定期檢查共用權限**
3. ✅ **重要資料定期備份**(檔案 → 建立副本)
4. ✅ **使用「保護工作表」功能**保護重要欄位
5. ✅ **版本歷史記錄**: 檔案 → 版本記錄 → 查看版本記錄

---

## 📚 相關文件

- **SIMPLE_SHEETS_GUIDE.md** - 簡易 CSV 整合完整指南
- **csv_samples/** - 匯出的 CSV 範例檔案
- **API 參考**: `api_specification.md`

---

## 💡 常見問題

### Q1: 匯入 CSV 時中文顯示亂碼怎麼辦?
**A**: 確保 CSV 檔案是 UTF-8-sig 編碼。本專案匯出的 CSV 已自動處理編碼問題。

### Q2: 如何批次更新資料?
**A**: 在 Google Sheets 編輯完成後,匯出 CSV 並透過管理後台匯入即可批次更新。

### Q3: 可以自動同步嗎?
**A**: 目前使用 CSV 方案為手動同步。如需自動同步,請參考 `GOOGLE_SHEETS_SETUP.md` 設定 API 整合。

### Q4: 報名率公式顯示錯誤?
**A**: 檢查名額欄位是否為 0 或空白。使用 `=IF(G2>0, H2/G2, 0)` 可避免除以零錯誤。

---

**最後更新**: 2025-10-01
**維護者**: 系友會技術團隊
