# ç°¡æ˜“ Google Sheets æ•´åˆæŒ‡å— (å…è²»æ–¹æ¡ˆ)

## ğŸ¯ æ¦‚è¿°

ä½¿ç”¨ Google Sheets + CSV åŒ¯å…¥/åŒ¯å‡ºçš„æ–¹å¼,**å®Œå…¨å…è²»ä¸”ç„¡éœ€ API è¨­å®š**!

---

## ğŸ“‹ Step 1: å»ºç«‹ Google Sheets

### 1. å»ºç«‹ç³»å‹è³‡æ–™è¡¨

å‰å¾€ [Google Sheets](https://sheets.google.com/) ä¸¦å»ºç«‹æ–°è©¦ç®—è¡¨:

**è©¦ç®—è¡¨åç¨±**: `è‰²å½©èˆ‡ç…§æ˜ç§‘æŠ€ç ”ç©¶æ‰€ - ç³»å‹è³‡æ–™åº«`

### 2. å»ºç«‹åˆ†é  (Sheets)

å»ºç«‹ä»¥ä¸‹åˆ†é :
1. **ç³»å‹å¸³è™Ÿæ¸…å–®**
2. **è·ç¼ºç™¼å¸ƒæ¸…å–®**
3. **æ´»å‹•æ¸…å–®**
4. **å·¥ä½œç¶“æ­·è¨˜éŒ„**
5. **å…¬å‘Šç™¼å¸ƒæ¸…å–®**

---

## ğŸ“Š Step 2: è¨­å®šå„åˆ†é æ¬„ä½

### åˆ†é  1: ç³»å‹å¸³è™Ÿæ¸…å–®

**ç¬¬ä¸€è¡Œ(æ¨™é¡Œåˆ—)**:
```
ID | é›»å­éƒµä»¶ | å§“å | è§’è‰² | ç‹€æ…‹ | ç•¢æ¥­å¹´ä»½ | ç›®å‰å…¬å¸ | è·ä½ | æ‰€åœ¨åœ° | è¯çµ¡é›»è©± | LinkedIn | è¨»å†Šæ—¥æœŸ | æœ€å¾Œæ›´æ–°
```

**è³‡æ–™é©—è­‰è¨­å®š**:
- **è§’è‰²** (Eæ¬„): ä¸‹æ‹‰é¸å–® â†’ `user,admin`
- **ç‹€æ…‹** (Fæ¬„): ä¸‹æ‹‰é¸å–® â†’ `active,inactive,suspended`

**æ¢ä»¶æ ¼å¼åŒ–**:
- é¸å– Eæ¬„(ç‹€æ…‹)
- æ ¼å¼ â†’ æ¢ä»¶å¼æ ¼å¼
- è¦å‰‡: ç­‰æ–¼ `active` â†’ ç¶ è‰²èƒŒæ™¯
- è¦å‰‡: ç­‰æ–¼ `inactive` â†’ ç°è‰²èƒŒæ™¯

### åˆ†é  2: è·ç¼ºç™¼å¸ƒæ¸…å–®

```
ID | ç™¼å¸ƒè€… | è·ç¼ºæ¨™é¡Œ | å…¬å¸åç¨± | åœ°é» | è–ªè³‡ç¯„åœ | è·ç¼ºç‹€æ…‹ | äº¤æµè«‹æ±‚æ•¸ | ç™¼å¸ƒæ—¥æœŸ
```

### åˆ†é  3: æ´»å‹•æ¸…å–®

```
ID | æ´»å‹•åç¨± | æ´»å‹•æ—¥æœŸ | æ´»å‹•æ™‚é–“ | åœ°é» | æ´»å‹•é¡å‹ | åé¡ | å·²å ±å | å ±åç‡ | ç‹€æ…‹
```

**å…¬å¼ (Iæ¬„ - å ±åç‡)**:
```
=IF(G2>0, H2/G2, 0)
```
æ ¼å¼åŒ–ç‚ºç™¾åˆ†æ¯”

### åˆ†é  4: å·¥ä½œç¶“æ­·è¨˜éŒ„

```
ID | ä½¿ç”¨è€…ID | ä½¿ç”¨è€…å§“å | å…¬å¸åç¨± | è·ä½ | åœ°é» | é¡å‹ | é–‹å§‹æ—¥æœŸ | çµæŸæ—¥æœŸ | ç›®å‰åœ¨è· | ä»»è·æœˆæ•¸
```

**æŸ¥è©¢å…¬å¼ (Cæ¬„ - ä½¿ç”¨è€…å§“å)**:
```
=IFERROR(VLOOKUP(B2,ç³»å‹å¸³è™Ÿæ¸…å–®!A:C,3,0),"")
```

---

## ğŸ“¥ Step 3: å¾ç³»çµ±åŒ¯å‡º CSV

### å¾Œç«¯å¯¦ä½œåŒ¯å‡ºåŠŸèƒ½

å»ºç«‹åŒ¯å‡º API:
```python
# alumni_platform_api/src/routes/export.py

from flask import Blueprint, send_file
import csv
import io

export_bp = Blueprint('export', __name__)

@export_bp.route('/api/export/users', methods=['GET'])
def export_users():
    """åŒ¯å‡ºä½¿ç”¨è€…è³‡æ–™ç‚º CSV"""
    from models.user import User, Profile
    
    # æŸ¥è©¢æ‰€æœ‰ä½¿ç”¨è€…
    users = User.query.all()
    
    # å»ºç«‹ CSV
    output = io.StringIO()
    writer = csv.writer(output)
    
    # å¯«å…¥æ¨™é¡Œ
    writer.writerow([
        'ID', 'é›»å­éƒµä»¶', 'å§“å', 'è§’è‰²', 'ç‹€æ…‹', 
        'ç•¢æ¥­å¹´ä»½', 'ç›®å‰å…¬å¸', 'è·ä½', 'æ‰€åœ¨åœ°', 
        'è¯çµ¡é›»è©±', 'LinkedIn', 'è¨»å†Šæ—¥æœŸ', 'æœ€å¾Œæ›´æ–°'
    ])
    
    # å¯«å…¥è³‡æ–™
    for user in users:
        profile = user.profile
        writer.writerow([
            user.id,
            user.email,
            user.name,
            'user',  # è§’è‰²
            'active',  # ç‹€æ…‹
            user.graduation_year,
            profile.current_company if profile else '',
            profile.current_title if profile else '',
            '',  # æ‰€åœ¨åœ°
            '',  # é›»è©±
            '',  # LinkedIn
            user.created_at.strftime('%Y-%m-%d'),
            user.updated_at.strftime('%Y-%m-%d')
        ])
    
    # æº–å‚™ä¸‹è¼‰
    output.seek(0)
    return send_file(
        io.BytesIO(output.getvalue().encode('utf-8-sig')),  # æ”¯æ´ä¸­æ–‡
        mimetype='text/csv',
        as_attachment=True,
        download_name='ç³»å‹è³‡æ–™.csv'
    )
```

### å‰ç«¯æ–°å¢åŒ¯å‡ºæŒ‰éˆ•

åœ¨ç®¡ç†å¾Œå°åŠ å…¥:
```jsx
<button onClick={() => {
  window.location.href = 'http://localhost:5001/api/export/users';
}}>
  ğŸ“¥ åŒ¯å‡ºç³»å‹è³‡æ–™ CSV
</button>
```

---

## ğŸ“¤ Step 4: åŒ¯å…¥ CSV åˆ°ç³»çµ±

### åŒ¯å…¥æµç¨‹

1. å¾ Google Sheets ä¸‹è¼‰ CSV:
   - æª”æ¡ˆ â†’ ä¸‹è¼‰ â†’ é€—è™Ÿåˆ†éš”å€¼ (.csv)

2. é€éå¾Œå°ä¸Šå‚³ CSV:

```python
# alumni_platform_api/src/routes/import.py

@import_bp.route('/api/import/users', methods=['POST'])
def import_users():
    """å¾ CSV åŒ¯å…¥ä½¿ç”¨è€…"""
    import csv
    from werkzeug.utils import secure_filename
    
    file = request.files['file']
    if not file:
        return {'error': 'è«‹é¸æ“‡æª”æ¡ˆ'}, 400
    
    # è®€å– CSV
    stream = io.StringIO(file.stream.read().decode('utf-8-sig'))
    reader = csv.DictReader(stream)
    
    imported_count = 0
    errors = []
    
    for row in reader:
        try:
            # æª¢æŸ¥ä½¿ç”¨è€…æ˜¯å¦å­˜åœ¨
            user = User.query.filter_by(email=row['é›»å­éƒµä»¶']).first()
            
            if user:
                # æ›´æ–°ç¾æœ‰ä½¿ç”¨è€…
                user.name = row['å§“å']
                user.graduation_year = int(row['ç•¢æ¥­å¹´ä»½'])
            else:
                # å»ºç«‹æ–°ä½¿ç”¨è€…
                user = User(
                    email=row['é›»å­éƒµä»¶'],
                    name=row['å§“å'],
                    graduation_year=int(row['ç•¢æ¥­å¹´ä»½'])
                )
                user.set_password('default123')  # é è¨­å¯†ç¢¼
                db.session.add(user)
            
            db.session.commit()
            imported_count += 1
            
        except Exception as e:
            errors.append(f"ç¬¬ {reader.line_num} è¡Œ: {str(e)}")
    
    return {
        'success': True,
        'imported': imported_count,
        'errors': errors
    }
```

---

## ğŸ”„ ä½¿ç”¨æµç¨‹

### æ—¥å¸¸æ“ä½œæµç¨‹

```
1. åœ¨ Google Sheets ç·¨è¼¯è³‡æ–™
   â†“
2. æª”æ¡ˆ â†’ ä¸‹è¼‰ â†’ CSV
   â†“
3. ç™»å…¥ç®¡ç†å¾Œå°
   â†“
4. è³‡æ–™ç®¡ç† â†’ åŒ¯å…¥ CSV
   â†“
5. é¸æ“‡æª”æ¡ˆ â†’ ä¸Šå‚³
   â†“
6. ç³»çµ±è‡ªå‹•åŒ¯å…¥ä¸¦æ›´æ–°è³‡æ–™åº«
```

### åå‘æ“ä½œ(åŒ¯å‡º)

```
1. ç™»å…¥ç®¡ç†å¾Œå°
   â†“
2. é»æ“Šã€ŒåŒ¯å‡º CSVã€
   â†“
3. ä¸‹è¼‰ CSV æª”æ¡ˆ
   â†“
4. é–‹å•Ÿ Google Sheets
   â†“
5. æª”æ¡ˆ â†’ åŒ¯å…¥ â†’ ä¸Šå‚³
   â†“
6. å–ä»£ç›®å‰çš„å·¥ä½œè¡¨
```

---

## ğŸ“ CSV æª”æ¡ˆç¯„ä¾‹

### users.csv
```csv
ID,é›»å­éƒµä»¶,å§“å,è§’è‰²,ç‹€æ…‹,ç•¢æ¥­å¹´ä»½,ç›®å‰å…¬å¸,è·ä½,æ‰€åœ¨åœ°,è¯çµ¡é›»è©±,LinkedIn,è¨»å†Šæ—¥æœŸ,æœ€å¾Œæ›´æ–°
1,admin@example.com,ç³»çµ±ç®¡ç†å“¡,admin,active,2018,ç³»å‹æœƒ,ç³»çµ±ç®¡ç†å“¡,å°åŒ—,0912345678,,2025-10-01,2025-10-01
2,wang@example.com,ç‹å°æ˜,user,active,2020,ASUS,å…‰å­¸å·¥ç¨‹å¸«,å°åŒ—,,,2025-10-01,2025-10-01
```

---

## âœ… å„ªé»

1. âœ… **å®Œå…¨å…è²»** - ä¸éœ€è¦ä»»ä½•ä»˜è²»æœå‹™
2. âœ… **ç„¡éœ€ API** - ä¸ç”¨è¨­å®š Google Cloud
3. âœ… **å®‰å…¨** - æ²’æœ‰èªè­‰æª”æ¡ˆè¦ç®¡ç†
4. âœ… **ç°¡å–®** - ç®¡ç†å“¡å®¹æ˜“æ“ä½œ
5. âœ… **å”ä½œ** - å¤šäººå¯åŒæ™‚ç·¨è¼¯ Google Sheets
6. âœ… **å‚™ä»½** - Google è‡ªå‹•é›²ç«¯å‚™ä»½
7. âœ… **å½ˆæ€§** - å¯éš¨æ™‚åŒ¯å…¥/åŒ¯å‡º

---

## ğŸ¯ èˆ‡ API æ–¹æ¡ˆæ¯”è¼ƒ

| åŠŸèƒ½ | CSV æ–¹æ¡ˆ | API æ–¹æ¡ˆ |
|------|---------|---------|
| è²»ç”¨ | å…è²» | å…è²»(æœ‰é…é¡) |
| è¨­å®šè¤‡é›œåº¦ | â­ ç°¡å–® | â­â­â­â­ è¤‡é›œ |
| å³æ™‚åŒæ­¥ | âŒ æ‰‹å‹• | âœ… è‡ªå‹• |
| å®‰å…¨æ€§ç®¡ç† | â­â­â­â­â­ ç°¡å–® | â­â­ è¤‡é›œ |
| å¤šäººå”ä½œ | âœ… æ”¯æ´ | âœ… æ”¯æ´ |
| æ¨è–¦åº¦ | â­â­â­â­â­ | â­â­â­ |

---

## ğŸ’¡ å»ºè­°

**å°æ–¼ç³»å‹æœƒå¹³å°,æˆ‘å¼·çƒˆæ¨è–¦ä½¿ç”¨ CSV æ–¹æ¡ˆ**,å› ç‚º:

1. è³‡æ–™æ›´æ–°é »ç‡ä¸é«˜(ä¸éœ€è¦å³æ™‚åŒæ­¥)
2. æ“ä½œç°¡å–®,ç®¡ç†å“¡å®¹æ˜“ä¸Šæ‰‹
3. ä¸éœ€è¦è™•ç†è¤‡é›œçš„èªè­‰å•é¡Œ
4. å®Œå…¨å…è²»ä¸”å®‰å…¨
5. æœªä¾†éœ€è¦æ™‚å†å‡ç´šåˆ° API æ–¹æ¡ˆ

---

**æœ€å¾Œæ›´æ–°**: 2025-10-01
**ç¶­è­·è€…**: ç³»å‹æœƒæŠ€è¡“åœ˜éšŠ
